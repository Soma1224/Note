

# 计算机网路原理    西安交大

## 1-51	第1讲 概述一

- 以单处理器为中心得多终端连接系统

![1545181804603](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545181804603.png)





arpanet现代网络的原型，现代网络的TCP/IP协议集就是arpanet的第二代网路协议集

以下就是arpanet网络的思想：

- 分布式网络结构

![1545183035645](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545183035645.png)



为解决三台主机的通讯问题arpanet提出以下思想：

ccp是通讯控制处理器：把主机原来需要做的跟通讯相关的所有功能从主机当中剥离出来

host主机：主要进行数据的处理

ccp需要考虑的问题：数据本身是什么不重要，重要的是==主机所提的要求==和==目的节点的地址是什么==

根据目的节点的地址确定如何发送能送到目的节点

根据要求来确定数据应该如何转发，比如==应该优先保证数据传输的可靠性==还是==优先保证数据传输的实时性==

![1545183287893](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545183287893.png)







## 1-50	第2讲 概述二

![1545184251462](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545184251462.png)



### 数据分为等长的好还是不等长的好？

ATM网络，采用信元的方式进行传输，保持53个字节。优点：中间处理方式比较简单，能提高数据发送的效率。缺点：到底选择多长？太短的话数据传输的有效利用率就低，，选的太长的话，对于短数据的传输需要补充，有效利用率不高。



现代的计算机网络都采用分组的方式。只规定了最大长度，把要求数据等长。



### 为什么要先存储后转发？

**纠错**

因为现代的计算机网络不能保证全连接，肯定存在中间节点的，所以要保证数据的完整性，不出错的话只能在中间节点上先存储纠错

**排队**

A和B同时经过C向D发送数据，由于只有C向D的一条出口链路，所以数据必须排队，只要是排队的话，就需要把数据存储起来。

**寻址**

中间节点要解决的一个核心的问题就是要选择一条合适路径把数据转发到目的结点，要想进行寻址首要的工作就是接收数据把它缓存起来，然后再进行寻址。寻址的过程中还需要进行查表然后再决定以何种方式进行数据的转发，在这中间如果有数据进来了的话就需要对进来的数据进行缓存。





## 1-49	第3讲 概述三



## 1-48	第4讲 概述四&网络体系结构一

集线器和交换机的区别？

广播式和点到点式的区别和各自的优缺点？





## 1-47	第5讲 网络体系结构二





## 1-46	第6讲 网络体系结构三

### 协议数据单元

![1545785746211](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545785746211.png)

### 

| 数据传输协议 | 协议数据单元     |
| ------------ | ---------------- |
| FTP          |                  |
| TCP          | 报头             |
| IP           | 分组头（分组）   |
| 以太网       | 帧头和帧尾（帧） |



![1545787341474](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545787341474.png)



### 接口数据单元

![1545785646864](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545785646864.png)



在n+1层的角度上来讲，传输给n层的接口数据就是第n+1层的协议数据单元



接口控制信息ICI只有在第n+1层的协议数据单元通过接口的时候才会有作用，一旦进入到第n层，这个接口控制信息ICI就被丢掉了，但是不是不加处理地丢掉，举例：在邮局寄信，给邮局的工作人员说我需要寄一封挂号信，挂号信就是接口控制信息，对于寄信的人来说，他只向邮局提了个要求，但是至于邮局如何实现这个要求的话，寄信人是不得而知的，所以寄信人只能以一个服务质量的参数去描述它，邮局的工作人员在听到要求后在信上贴了挂号信的标志，**这个挂号信的标志相当于下层的协议控制信息PCI**

**上层通过接口传送数据，并且提传送数据服务质量的要求的时候，下层会根据这个要求做处理，来在下层的协议控制单元添加一定的协议控制信息**

**上层只提供传送的数据是什么（信），服务质量要求是什么（挂号信），上层没有办法了解下层是怎么实现的，要求就是接口控制信息。**





### 服务数据单元

![1545785978501](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545785978501.png)

上层的用户数据，站在本层的角度上来看就是服务数据单元，服务数据单元是作为一个整体来传送的，例如下图中IP是把TCP的用户信息进行分组的，所以IP传给TCP的时候也要把数据合并成原数据形式进行传输，这个就是服务数据单元提出的目的。

![1545789576784](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545789576784.png)







![1545786074820](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1545786074820.png)







## 1-45	第7讲 网络体系结构四

### 上节回顾：

- ==面向连接==的方式：电话
  - 在数据传输之前建立连接的方式来给数据的传送预先分配一定的资源，由于这些资源是预先分配的，所以不管用的到用不到，分配总会在那里，会造成一定的资源浪费，而且用户的数量会有所限制（电话系统可用的带宽都分配完的时候，连接就没有办法建立起来了）
  - 通过资源的预先分配保证数据在传输过程中的服务质量



- ==无连接==的方式：邮政系统
  - 每个数据都携带相关完整的目的地址和控制信息
  - 每一个数据都是独立地进行发送的
  - 在数据发送之前并不会预先分配资源，中间结点根本不知道会有这样的一个数据到达
  - 优点：资源的利用率高，尽可能为更多的用户提供服务
  - 缺点：服务质量没有办法得到保证（用户多，传输时延增加）





- 使用面向连接和无连接的哪一种方式，取决于以下两个方面：

  - 网络是一个什么样的环境（有线网路连接可靠，误码率低，为了简化协议的设计采用无连接的方式提高传输的效率。无线网络由于误码率高，制定协议的时候应该采用面向连接的方式来解决误码率的问题）
  - 协议设计的出发点是什么，致力于提供什么样的服务（例如IP协议是使用了一种无连接的方式，协议设计的目的就是为了使数据能够到达即可，如果上层用户对可靠性要求比较高的情况下，上层一定还会做可靠性的工作）



  **每一层的下层提供什么样的服务（面向连接/无连接）于本层提供什么样的服务（面向连接/无连接）没有联系**





  ### 开放系统互联参考模型提出的服务==原语==





  ![1547529083770](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1547529083770.png)

- 请求（Request）

- 指示（Indication）

- 响应（Response）

- 确认（Confirm）



服务、协议和二者关系

- 服务：是各层**向上**提供一种原语，==只定义接口不涉及具体实现==
- 协议：定义同层==对等实体==间的具体规则
- 二者关系：实体利用**协议**完成**服务**定义的**接口**，只要服务不变，可以任意更改协议



### 两个网络体系结构的实例

#### 开放系统互连参考模型

![7层网络](.\picture\7层网络.jpg)



按照通信子网和资源子网的划分的概念：

- 1~3：通信子网
- 5~7：资源子网
- 传输层在通信子网和资源子网之间起到一个承上启下的作用



#### 各层介绍：

##### ==通讯子网完成的主要功能层：物理层，数据链路层，网络层，有了这三层的服务，能把源节点的数据转发到目的节点==

###### 物理层：在物理介质上发送和接收比特（bit）流（二进制位流）解决的是点到点的问题：一条物理介质两个结点传输的问题

物理层的特性：

- 机械特性：物理连接器的尺寸、形状、规格
- 电气特性：信号电平，脉冲宽度，频率，数据传输速率，最大传送距离等
- 规程特性：信号时序，应答关系，操作过程（例如同步的问题：1.接收方要按照发送方发送的频率来接收数据2. 接收方能识别发送方发送的数据的起始和结束位置）

==如何知道起始和结束的位置呢？==

需要特定的信号的组合或者特定的信号的应答关系，例如10M以太网，它在发送数据之前，首先发送==8Byte==的信号，其中等于（8=7+1），即**7个10101010**和**1个10101011**，前7个字节是为了同步，即告诉接收方发送的频率到底是多少，最后的1个字节是确定有效数据的起始位置，最后两位11后面紧接着是有效数据位开始了！



- 功能特性：接口引脚的功能作用



出现的问题：

1. 如果A和B传输的过程中增加了结点C的话，如何实现A给B发送的数据C不能接收到呢？**这就要对节点进行编制**
2. A和B进行二进制数据传输的时候会出错，B并不能识别出A想要传输的原始正确数据是什么，如果出现了误码的话B作为接收方是不能解决的

总结：单纯设计物理层是没有办法解决点到点之间传输的问题1和2的。



###### 数据链路层：在物理线路上提供一条可靠的数据传输，使之对网络层呈现为一条无错的，点到点的链路。

主要功能和服务（主要解决的一些问题）：

- **物理地址**

考虑到多点连接的情况，我们需要给每一个节点==唯一==的物理地址，

**为什么称之为物理地址呢？**

因为这个地址是判定是否接收一个数据的唯一的标志。

网卡地址是一种典型的物理地址，一个网卡判定是否接收一个数据的唯一标志就是这个数据所携带的物理地址是否等于本网卡的地址。是就接收，不是就不接收。

物理地址是全球唯一的。

- **成帧**

设计数据链路层的目的是为了给点到点的物理链路上面的传输增加适当的控制，简单的说，就是把原始的二进制位流增加一些控制信息，构成数据链路层的协议数据单元，能保证向上层呈现无错的数据链路

- **定界与同步**

简单的说就是划分帧的边界，能准确的识别出帧的起始位置和结束位置

- **差错控制**

主要工作有两点：差错的检测和差错的恢复

下层传输数据到上层的时候为了保证数据没有差错，通常在原始的二进制位流的基础上要增加冗余位，在发送方**约定例如m位的传输位和r位的冗余位要满足一定的关系**，在接收方就要去重新地检测m和r的关系是否满足，若满足，接收方认为数据没有出错，若不满足，数据肯定出错。

例如：奇偶校验码

冗余位越短越好，因为冗余位越短，传输率越高

不管m位如何，r的长度是固定的，协议控制信息设计有要求的，最好协议控制信息是固定	的。

要想检测出差错，还想要纠正出差错，必需增加更多的冗余信息，例如海明码，要想纠错一位信息，七位数据加了四位的冗余位；奇偶校验码纠错一位差错，只需加一位冗余位即可。

所以现代的网络协议，绝大多数的差错控制都采**用检错加重发**的方式。

- **流量控制**

解决收发方数据流量处理能力不匹配的问题，

- **信道的访问控制**

如果使用的是总线型拓扑结构，并采用广播式的信道连接方式，在这种条件下，我们要解决冲突的问题。



有了物理层和数据链路层，我们能够保证两个直接相连的节点之间的数据通信能够顺畅正确的进行。但是在通讯子网中，光有物理层和数据链路层是不够的，因为在大多数情况下，包括在广域网当中，是不能保证所有的节点是直接相连的，可能需要通过其他的节点和其他的网络的转接，所以在数据链路层之上设计了一个网络层。





## 1-44	第8讲 网络体系结构五

###### 网络层：在源节点和目的节点之间提供端到端的数据传输

==网络层，通过路由选择，能够保证的使源节点的数据能够成功传递到目的节点。==

**主要功能与服务：**

- **路由选择（必须实现）**

端到端要解决路由选择问题，要解决路由选择的问题，就是要解决统一编址的问题，地址必须是全局唯一性。



问题：**我们能不能使用物理地址（网卡地址）来解决路由选择的问题？**

| 目的节点 | 下一个节点（把数据送给这个节点就能保证数据能够送达目的节点） |
| -------- | ------------------------------------------------------------ |
|          |                                                              |

不能，原因1：因为这样会把所有的物理地址填入到目的节点中，这样会使这张路由表变得非常庞大。原因2：物理地址不会知道下一个节点是在哪里，因为网卡出厂的时候根本不知道会被卖到哪里去。



所以必须给每个节点提供==逻辑地址==，例如IP地址，IP地址不像网卡一样固化在电脑上面，而是用户手工配置进去的而且可以随意修改，IP地址本身带有明确的==地域特征==（通过这个节点的地址就能知道在哪个网络），IP地址可以减轻路由器的存储压力和帮助路由器提高查表转发速度。



但是这样做有一个问题：一个节点接收一个数据的唯一判断标志就是根据物理地址，所以需要相关的协议，例如ARP协议，通过这个协议完成IP地址到物理地址的转换。



举例说明IP地址和物理地址的关系：

到邮局去寄信，为了使收件人收到这封信，必须提供收信人地址（IP地址）和收信人姓名（物理地址），邮政系统在转发这封信的时候，在到达班级邮箱之前，收信人姓名（物理地址）是一点用都没有的，邮政系统始终在用收信人地址（IP地址）在进行信件的转发，只有这封信到达班级邮箱之后收信人姓名（物理地址）才起作用。

**也就是在进入目的节点所在的子网之前，中间层的通讯子网始终是在通过IP地址在进行路由选择，只有在进入目的节点所在的子网之后，物理地址才起作用，然后需要ARP这样的一个协议，完成IP地址到物理地址的一个转换，然后通过物理地址来保证目的节点的网卡是否接收这个数据**

- **数据的分组转发（必须实现）**

两个节点不是直接可达的，所以要通过路由表来进行数据的分组和转发。数据的分段和重组也会涉及到的。

- **流量控制和拥塞控制（有选择的实现）**

拥塞：因为网络当中分组数量太多，造成整个网络转发质量下降的现象就是拥塞控制。

- **差错检测与恢复（有选择的实现）**

与数据链路层的区别就是检测的算法会不一致。

- **审计：流量统计和记账（有选择的实现）**



总结：不是说列出来的功能网络层就必须实现，有必须实现和可以选择的实现这两种方式。



我们需要了解到在进行网络连接的时候，第一：需要知道通信子网是上面样的物理结构，第二：需要知道所连接的通讯子网能够提供一种怎样的服务。如何做到这一点？



##### 传输层：为源端主机到目的端主机提供可靠的，满足服务质量要求的数据传输服务。

主要功能和服务：

- ==屏蔽==不同通讯子网的差异，使上下层不受通信子网变化的影响
- ==弥补==资源子网和通信子网之间的差异（例如视频点播的缓冲）
- 提供==进程级==的通讯能力（端口号）



**网络层的端到端是指源节点到目的节点是通讯子网的端到端，传输层的端到端是指源主机到目的主机是资源子网的端到端**

![1549357366799](.\picture\%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1549357366799.png)

###### 三个地址

数据的通讯和网络的寻址是怎么进行的？

- IP地址：通过==IP地址==进行路由选择，定位到目的节点所在的子网
- 物理地址：通过==物理地址==定位到某一个具体的主机
- 端口号：通过==端口号==定位到某一个特定主机的某一个应用进程



网络体系在研究的时候一般情况下会选择一个模板，常用的是两个，一个是==开放系统互联参考模型==，另一个是==抽象的五层模型==。两者的关系就是低四层是一一对应的，抽象的五层模型是没有会话层和表示层的，只有应用层的。



##### 应用层：负责用户信息的语义表示，为用户的应用程序提供网络通讯服务，给用户提供了一个调用和使用网络体系的一个接口，应用层是最复杂的一层，是因为应用层的协议非常多，多的原因是不同用户对网络的要求是不一样的



为什么开放系统参考模型设计了会话层和表示层呢？

既然有这么多的应用层，我们能不能把所有应用层所要解决的问题提取出来形成一个层次，目的是简化应用层的设计

##### 表示层：解决用户信息的语法和语义的表示，处理被传输数据的表示问题（例如32位计算机和64位计算机的数据传输问题）

##### 会话层：会话的管理和信息的同步，建立、管理和终止不同机器上的应用程序之间的会话



==表示层和会话层一般没有对应的协议==



总结：

应用层（报文）：负责用户信息的语义表示，==即：做什么==

表示层（报文）：解决用户信息的语法和语义的表示，==即：任务怎么描述==

会话层（报文）：会话的管理和信息的同步，==即：从何时何处开始==

传输层（报文）：建立一条传输的连接，==即：对方在何处==

网络层（分组或包）：选择合适的路由，==即：走哪条路可以到达该处==

网络层（分组或包）：选择合适的路由，即：走哪条路可以到达该处

数据链路层（帧）：在链路上无差错地传送帧，==即：每一步应该怎么走==

物理层（比特）：将比特流送到物理链路上进行传送，==即：怎样利用物理链路==



==低三层是面向信息传输的通信子网的层次，高三层是面向信息处理的资源子网的层次，传输层起到了一个承上启下的作用。==



## 1-43	第9讲 网络体系结构六&数据通信技术一

### TCP/IP协议集：

![1550556250540](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1550556250540.png)

![1550557389028](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1550557389028.png)



![1550717798587](.\picture\%5CUsers%5Clenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1550717798587.png)



### 第三章 数据通信技术：

| 数据     |   信道   |
| -------- | :------: |
| 数字数据 | 模拟信道 |
| 数字数据 | 数字信道 |
| 模拟数据 | 模拟信道 |
| 模拟数据 | 数字信道 |



## 1-42	第10讲 数据通信技术二

在模拟信道上传输数据需要进行调制解调，在数字信道上传输数据需要编码和解码



### 基带信号

数据源发出的没有经过调制的原始电信号

### 频带信号

经过调制过的信号

## 1-41	第11讲 数据通信技术三





## 1-40	第12讲 数据通信技术四





## 1-39	第13讲 数据通信技术五





## 1-38	第14讲 数据通信技术五&数据链路控制一





## 1-37	第15讲 数据链路控制二





## 1-36	第16讲 数据链路控制三





## 1-35	第17讲 数据链路控制四





## 1-34	第18讲 数据链路控制五





## 1-33	第19讲 数据链路控制六





## 1-32	第20讲 数据链路控制七





## 1-31	第21讲 局域网技术一





## 1-30	第22讲 局域网技术二





## 1-29	第23讲 局域网技术三





## 1-28	第24讲 局域网技术四





## 1-27	第25讲 局域网技术五





## 1-26	第26讲 局域网技术六





## 1-25	第27讲 局域网技术七





## 1-24	第28讲 局域网技术八





## 1-23	第29讲 局域网技术九





## 1-22	第30讲 局域网技术十





## 1-21	第31讲 局域网技术十一





## 1-20	第32讲 局域网技术十二





## 1-19	第33讲 广域网技术一





## 1-18	第34讲 广域网技术二





## 1-17	第35讲 广域网技术三





## 1-16	第36讲 广域网技术四





## 1-15	第37讲 广域网技术五





## 1-14	第38讲 广域网技术六





## 1-13	第39讲 Internet基本原理一





## 1-12	第40讲 Internet基本原理二





## 1-11	第41讲 Internet基本原理三





## 1-10	第42讲 Internet基本原理四





## 1-09	第43讲 Internet基本原理五





## 1-08	第44讲 Internet基本原理六





## 1-07	第45讲 Internet基本原理七





## 1-06	第46讲 Internet基本原理八





## 1-05	第47讲 Internet基本原理九





## 1-04	第48讲 Internet应用一





## 1-03	第49讲 Internet应用二





## 1-02	第50讲 网络安全与管理一





 